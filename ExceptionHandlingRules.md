# Binodata 例外處理框架與規則

好的系統與軟體會有軟體強健度的設計，軟體強健度代表一個軟體的容錯能力有多好，容錯能力愈好的軟體，其軟體在運行的時候愈穩定。

# 軟體強健度等級分類模型 [參考來源](http://www.books.com.tw/products/0010637503)

## 軟體強健度等級分類如下表:


<table>
    <tr>
        <td>項目</td>
		<td>等級0</td>
		<td>等級1</td>
		<td>等級2</td>
		<td>等級3</td>
    </tr>
	<tr>
        <td>名稱</td>
		<td>未定義</td>
		<td>錯誤回報</td>
		<td>狀態回復</td>
		<td>行為回復</td>
    </tr>
	<tr>
        <td>服務</td>
		<td>隱含錯誤，或外顯的失敗</td>
		<td>外顯的失敗</td>
		<td>外顯的失敗</td>
		<td>持續提供</td>
    </tr>
	<tr>
        <td>狀態</td>
		<td>未知或不正確的狀態</td>
		<td>未知或不正確的狀態</td>
		<td>正確的狀態</td>
		<td>正確的狀態</td>
    </tr>
    <tr>
        <td>生命週期</td>
		<td>終止或繼續</td>
		<td>終止</td>
		<td>繼續</td>
		<td>繼續</td>
    </tr>
    <tr>
        <td>處理方式</td>
		<td>沒有處理</td>
		<td>* 傳遞所有未被處理的例外 <br> * 在主程式中回報所有例外</td>
		<td>* 錯誤處理 <br> * 資源釋放 </td>
		<td>* 重試 <br> * 設計執行其他替代方案</td>
    </tr>
</table>



## 一般需求專案的處理方式
* 底層例外發生，包括Binodata自己開發與設計的第三方套件等API, Lib 都需要丟出例外。
* 建立安全網，於最上層抓住所有例外。
* 例外的Log 處理，請於最上層抓住例外的地方紀錄Log，不要在內部抓取例外，並紀錄Log，會有多次紀錄Log的問題。
* 抓到錯誤後，依照該專案所定義的強健度等級選擇處理策略。
* 嚴重錯誤發生，務必要發通知告訴系統人員。


### 嚴重錯誤的定義

* 與第三方服務系統斷線，比如資料庫(Database)、驗證伺服器(AuthN/AuthZ Server)、信件伺服器、雲端服務等。
* 軟體設計錯誤所造成的錯誤
* 硬體的錯誤或攔截到作業系統層的錯誤。比如硬碟空間滿了，安全性的限制導至無法正確執行。


### 客製例外類別的設計

* 客製例外設計的原因: 要解決Error Code 定義的問題。因為，系統內的Error Code 定義太多，會需要管理Error Code的管理方式，並增加維護成本，找錯誤也比較不容易，且耗時。
* 透過客製的例外，可以定義自己服務的例外，或系統範圍的例外，透過命名就能知道例外的種類。


### 客製例外的命名建議

* 資料庫層級的例外

```cs
//Example
DaoException;
DataAccessException;
```

* Web Api 存取的例外

```cs
//Example

{服務名稱}WebApiException;
```
